var temp=document.createElement("script");function connect(){var e=document.createElement("script");e.innerHTML='var config = {\n    apiKey: "AIzaSyAy2o-FZGQDiy8orFTCTmJ7b3coUeQaoCc",\n    authDomain: "scratcheco-105a5.firebaseapp.com",\n    databaseURL: "https://scratcheco-105a5.firebaseio.com",\n    projectId: "scratcheco-105a5",\n    storageBucket: "",\n    messagingSenderId: "17817429622"\n  };\n  firebase.initializeApp(config);\n  function set(key,value){firebase.database().ref().child(key).set(value);}\n  firebase.database().ref().on(\'value\', snap => get = snap.val());\n',document.body.appendChild(e)}temp.src="https://www.gstatic.com/firebasejs/5.5.3/firebase.js",temp.onload=function(){connect()},document.getElementsByTagName("head")[0].appendChild(temp),document.head.appendChild(temp),window.onload=function(){var e=document.createElement("script");e.innerHTML="\n//искать тег [img] [/img] и вырезать из него url на картинку\nfunction getUrlImgFromMessege(messege){\nvar m = messege;\nvar i=0;\nvar text = [];\nwhile(m.indexOf('[img]')!=-1){\nvar s=m.indexOf('[img]')+5;\nvar e=m.indexOf('[/img]');\ntext[i] = m.substring(s,e).replace('[img]','');\nvar m=m.replace('[img]','').replace('[/img]','').replace(text,'');\ni++;\n}return text;}\n\n\n//сканирует все сообщения и переводит их в нормальные\nfunction makeReadable(){\nvar m = getMesseges();\nvar i=0;\nvar me;\nwhile(i!=m.length){\nme=m[i].substring(m[i].indexOf('☁')+1,m[i].replace('☁','').indexOf('☁')+1);\nif(parseInt(me)==me){\nm[i] = get['m'+me];\n}\ni++;\n}\nsetMesseges(m);\n}\n\nfunction addBtnAbout(){\nvar html = '<img onclick=\"openStats()\" src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAFiQAABYkBbWid+gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAGjSURBVEiJ3dW/S5VRGAfwj17vVKQ0hcO17tAvClIbm3SKBgf/gDBwkCZrKReJIgLdnMNosKChKYQgaMnAoZZIyqVAGposbmWh3oZzLvfel/ftvtp18QuHc97z/Pie9z3f53nZYxRa2Iso42j0/d4u4uN4iHVUG8Yn3Eb3/yQfx28s4wpO4ggGcBNfsIbzu0k+hi1cR0eGz0E8wTec3knyEn7hRg7fAp7jDTrzEszhneaLL+IZXuFwwr+MPxjJS7CGa4m9HlSwiVMpMYt4kCd5t6CSCym2Ek5kxN0SxJCJrjgfiPOPhP199PmJcynxFeHSM1G7oK/CZygl7GcFpRzKiC8Jsm1JsIklXErYt6ItK/YiXv6LoBGXBZkea9ibxIxQ0TPoS/hvCG0kFwp4LWi7J+4NY7Rh1KTaL/SlO3mT19CLVXzAUIq9CxPx5BsY3CmBeMrH2MYK7mMWjwQxVOJ6Oz6n1UcunME0nuIFFnBVaHziuioUaHm3JK0wFUk+axZAW3E3knxUf7u2Yy6SvFVXYFvRgflIcm8vCAh1NCH8bvcR/gLcbFO0Hvor8QAAAABJRU5ErkJggg==\">';\ndocument.getElementsByClassName('header-text')[0].getElementsByTagName('h2')[0].innerHTML = a=document.getElementsByClassName('header-text')[0].getElementsByTagName('h2')[0].innerHTML+ html;\n}\n\nfunction makeReadableM(){\nvar m = getMessegesM();\nvar i=0;\nvar me;\nwhile(i!=m.length){\nme=m[i].substring(m[i].indexOf('☁')+1,m[i].replace('☁','').indexOf('☁')+1);\nif(parseInt(me)==me){\nm[i] = get['m'+me];\n}\ni++;\n}\nsetMessegesM(m);\n}\n\nfunction sendMessege(m){\ndocument.getElementsByClassName(\"control-group tooltip right\")[0].getElementsByTagName('textarea')[0].value=m;\ndocument.getElementsByClassName(\"control-group\")[1].getElementsByClassName(\"button small\")[0].click();\n}\n\nfunction antiB(i){\nif(i==0){\n//анти баг для кнопки на странице /messeges/\ndocument.getElementsByClassName(\"button messages-social-loadmore\")[0].setAttribute(\"onclick\",\"makeReadableM();\");\n}\n\nif(i==1){\n//антибаг для кнопки на странице проекта\nvar a=document.getElementsByClassName(\"comments\")[0].getElementsByTagName('div');\na[a.length-1].setAttribute(\"onclick\",\"makeReadable();\");\n}}\n\n//получить текст сообщения\n\nfunction getText(){\nreturn document.getElementById('comments').getElementsByTagName('textarea')[0].value\n}\n\n//создать кнопку\nfunction createBtn(){\nif(document.getElementById('btnSend')==null){\nvar para = document.createElement(\"div\");\npara.className = \"button small\";\npara.id = \"btnSend\";\npara.innerHTML = '<a onclick=\"sendCustom()\";>Send with ScratchEco</a>'\ndocument.getElementsByClassName(\"control-group\")[1].appendChild(para);\n}}\n\n//получает никнейм текущего профиля\nfunction getNickprofile(){\nreturn document.getElementsByClassName('header-text')[0].getElementsByTagName('h2')[0].innerText\n}\n\n//открывает статистику текущего профиля в новом окне\nfunction openStats(){\nwindow.open('https://scratchstats.com/#' + getNickprofile());\n}\n\n//получить текст сообщения(текст храниться в array)\nfunction getMesseges(){\nvar i=0;\nvar text = [];\nwhile(i!=document.getElementsByClassName(\"comments\")[0].getElementsByTagName('li').length){\ntext[i]=document.getElementsByClassName(\"comments\")[0].getElementsByTagName('li')[i].getElementsByClassName(\"content\")[0].innerHTML;\ni++;\n}return text;}\n//задать текст(текст храниться в array)\nfunction setMesseges(text){\nvar i=0;\nwhile(i!=document.getElementsByClassName(\"comments\")[0].getElementsByTagName('li').length){\ndocument.getElementsByClassName(\"comments\")[0].getElementsByTagName('li')[i].getElementsByClassName(\"content\")[0].innerHTML=text[i];\ni++;\n}}\n//сканирует и добавляет картинку к сообщению где надо + убирает мусор(теги)\nfunction tagsScan(){\nvar i=0;\nvar m=getMesseges();\nvar temp;\nvar para;\nwhile(i!=m.length){\nimg = getUrlImgFromMessege(m[i]);\nif(img.length!=0){\ntemp=0;\nwhile(temp!=img.length){\npara = document.createElement(\"img\");\npara.height = '128';\npara.src = img[temp];\nm[i] = m[i].replace('[img]'+img[temp]+'[/img]', '');\nm[i] = m[i]+para.outerHTML;\ntemp++;\n}\n}i++;}setMesseges(m);return m;}\n\n//получить сообщения на странице /messeges/\nfunction getMessegesM(){\nvar i=0;\nvar text = [];\nwhile(i!=document.getElementsByClassName(\"emoji-text mod-comment\").length){\ntext[i]=document.getElementsByClassName(\"emoji-text mod-comment\")[i].innerHTML;\ni++;\n}return text;}\n\n//задать сообщения на странице /messeges/\nfunction setMessegesM(text){\nvar i=0;\nwhile(i!=document.getElementsByClassName(\"emoji-text mod-comment\").length){\ndocument.getElementsByClassName(\"emoji-text mod-comment\")[i].innerHTML=text[i];\ni++;\n}}\n\n//получаем никнейм создателя проекта\nfunction getCredit(){return document.getElementById('owner').innerHTML;}\n\n//добавляет кнопку для гиф Trumbnail\nfunction addBtnGif(){\nvar para = document.createElement(\"div\");\npara.className = 'button';\npara.id = 'gifAdd';\npara.setAttribute(onclick,\"alert('ok')\");\npara.height = \"50\";\npara.setAttribute('onclick','gifSet();')\npara.innerHTML = \"<span>GIF Trumbnail</span>\";\ndocument.getElementsByClassName('buttons')[0].appendChild(para);\n}\n\n//гиф код от World_Languages\nfunction gifSet(){\nx=document.createElement(\"script\");x.src=\"//is.gd/thumb2\"; document.getElementsByTagName(\"head\")[0].appendChild(x);\n}\n\n//получает никнейм текущего аккуанта\nfunction getNickname(){\nif(document.getElementById('navigation')==null){return document.getElementsByTagName('span')[2].innerText;}\nelse{return document.getElementsByTagName('span')[8].innerText;}}\n\n//добавляет кнопку если нужно\nfunction addGif(){\n    if(document.getElementById('gifAdd')==null){\nif(getCredit()==getNickname()){addBtnGif();}}\n}\n\n//добавляет кнопку об комментах\nfunction addBtnhelp(){\n    if(document.getElementsByClassName('btnaboutm')[0]==undefined){\nvar a = `<div class='btnaboutm'><img src='https://simakyr.github.io/scratchEco/icons/about.png' height='16px'><div><h5>Help</h5><p>You can use for inject image [img]url to image[/img]</p></div></div>\n<style>.btnaboutm{\nheight:16px;\nwidth:16px;\n}\n.btnaboutm div {\ndisplay:none;\nposition: absolute;\nheight:60px;\nwidth:250px;\nbackground-color:grey;\nbox-shadow: 0 0 10px rgba(0,0,0,0.5);\npadding:10px;\nz-index: 1;\ncolor:white;\ntext-shadow: none;\nborder-radius: 10px;\n    }\n.btnaboutm:hover div {\n    display: inline;\n}\n</style>`;\ndocument.getElementsByClassName('control-group')[1].innerHTML = document.getElementsByClassName('control-group')[1].innerHTML + a;\n    }\n}\n//отправка для кнопки\nfunction sendCustom(){\nset('mL',get['mL']+1);\nset('m'+ get['mL'],getText());\nsendMessege('☁'+ get['mL'] +'☁');\n}\nrunM();\nfunction runM(){\nurl = document.location.href.split(\"/\").slice(3);\nif(url.includes('users') || url.includes('projects') || url.includes('comments')){\n//antiB(1);\n}\nelse{\n//antiB(0);\nmakeReadableM();\n}\n\nif(url.includes('users')){addBtnAbout();}\n\n}\ncarrot=0;\nsetInterval(fixes,1000);\nfunction fixes(){\n    if(url.includes('users') || url.includes('projects') || url.includes('comments')){\nmakeReadable();\ntagsScan();\ncreateBtn();\naddBtnhelp();\ncarrot=getMesseges().lenght;\nif(url.includes('projects')){\naddGif();\n}\n    }\n    else{\n    makeReadableM()\n    carrot=getMessegesM().lenght;\n    }\n}\n",document.head.appendChild(e)};
